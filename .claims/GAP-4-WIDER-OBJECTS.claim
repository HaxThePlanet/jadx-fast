# GAP-4: `tryWiderObjects()` with Full Hierarchy Walk
**Status:** COMPLETED
**Agent:** Claude Opus 4.5
**Date:** Dec 27, 2025

## Issue
Dexterity's `try_wider_objects()` only tried immediate superclass, not full class hierarchy chain like JADX.

## Solution
Implemented full hierarchy walking matching JADX's `FixTypesVisitor.tryWiderObjects()` algorithm.

## Changes Made

### 1. Made `collect_ancestors()` public in ClassHierarchy
**File:** `crates/dexterity-ir/src/class_hierarchy.rs`
- Changed `fn collect_ancestors` to `pub fn collect_ancestors`
- This method already existed and recursively collects all ancestors (superclasses + interfaces)

### 2. Rewrote `try_wider_objects()` in FixTypesVisitor
**File:** `crates/dexterity-passes/src/fix_types.rs:1130-1233`

**Before:** Only checked immediate superclass, returning true immediately if found.

**After:**
- Uses `hierarchy.collect_ancestors()` to get ALL ancestors (not just immediate superclass)
- Iterates through all ancestors trying each as a candidate type
- Added `is_type_compatible_with_bounds()` helper to verify compatibility
- Returns true only when a compatible wider type is found

## JADX Reference
- `jadx-core/src/main/java/jadx/core/dex/visitors/typeinference/FixTypesVisitor.java:657-679`
- Uses `clsp.getSuperTypes()` which returns all ancestor types

## Testing
- All 416 dexterity-passes tests pass
- Release build successful
- APK decompilation verified working
