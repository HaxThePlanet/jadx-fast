Task: P0-BOOL-CHAIN - Return Logic Inverted (CRITICAL)
Claimed: 2025-12-24
Agent: Claude Opus 4.5 (LLM Agent)
Session: ACTIVE

Status: IN PROGRESS - Boolean Simplify Pass (Dec 25, 2025)

Problem:
Boolean PHI patterns generate inverted return logic. 13 of 14 conditions in
detectEmulator$lambda$1() return the WRONG value.

JADX (correct):
```java
if (!StringsKt.startsWith$default(str, "generic", ...)) {
    if (!StringsKt.contains$default(str3, "ranchu", ...)) {
        return false;  // Early return when condition fails
    }
}
return true;  // All emulator checks passed
```

Dexterity (WRONG - logic inverted):
```java
boolean z = false;
if (!StringsKt.startsWith$default(str, "generic", ...)) {
    if (StringsKt.contains$default(str3, "ranchu", ...)) {
        z = true;  // Condition inverted AND using PHI pattern
    }
}
return z;  // Returns FALSE when emulator detected (backwards!)
```

Root Cause Analysis:
The PHI variable pattern (z=false; if(C) {z=true;} return z;) doesn't preserve
the early-return semantics. The nested conditions get inverted when converted
to this pattern, and the return value is backwards.

Previous Investigation:
- TernaryMod pass implemented correctly for ternary operators
- But P0-BOOL-CHAIN is NOT a ternary operator issue
- It's a boolean PHI pattern restructuring issue
- TernaryMod doesn't fix this pattern (different control flow)

Solution Required:
Implement Boolean Simplify Pass to convert PHI patterns to early returns:
1. Detect: z = false; if (C) { z = true; } return z;
2. Transform to: if (!C) { return false; } return true;
3. Requires condition inversion + control flow restructuring

Impact:
- Affects detectEmulator$lambda$1() - 13 of 14 conditions return wrong value
- This is a correctness bug (P0 - code won't compile/run correctly)
- Estimated 0.5-1% quality impact on large APK

Files to Modify:
- New pass: crates/dexterity-passes/src/boolean_simplify.rs
- Pipeline integration: crates/dexterity-codegen/src/lib.rs

JADX Reference: TernaryMod.java for PHI-to-return pattern transformation logic
